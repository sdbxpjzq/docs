[TOC]

# 大促的前与后

## 前端展示页面

下面只是一个栗子(只有员工身份可以看呀):

https://www.mafengwo.cn/sales/promotion.php?id=53&ts=2017-08-20

## 后台配置

https://seller.mafengwo.cn/#/marketing/promotion

是不是被吓到了😁



# 页面是怎么生成的呢

## 入口文件

`mobile`

- php: `sales/mobile/htdocs/sales/promotion.php`
- tpl: `sales/mobile/template/sales/promotion.tpl`

`pc`

- php: `sales/www2011/htdocs/sales/promotion.php`
- tpl: `sales/www2011/template/sales/promotion.tpl`

## 后台配置:

我们拿分会场入口做栗子:

前端展示:

![](https://ws2.sinaimg.cn/large/006tKfTcly1fj2pidqfuoj31kw0kztd9.jpg)

后台配置:

![](https://ws3.sinaimg.cn/large/006tKfTcly1fj2pj3rpv2j31kw0o3gpf.jpg)



后台配置的每一个模块对应着前端展示的一个模块.

- 模块名称:  区分当前是哪个模块的配置
- 模块样式: 

这个要与`tpl`文件名保持一致.

`seller/static/app/controllers/marketing/promotionController.js`

在这个文件可以增加或者删除配置.

- 维度

这个是从数据结构层面划分. (具体开发新模块时 可以讨论).

现在存在的维度有: `d0`,`d1`,`d2`,`d3`.

或许你还是有疑问, 维度是怎么区分的呢?来来我们看栗子

下面2个栗子:

![](https://ws4.sinaimg.cn/large/006tKfTcly1fj2q2d1is4j31cc0qe0vb.jpg)

![](https://ws3.sinaimg.cn/large/006tKfTcly1fj2q35j6pdj31dm0jcwg2.jpg)



别忘了, 维度还呼应前端的目录结构呢.

![](https://ws1.sinaimg.cn/large/006tKfTcly1fj2qifmoh6j304702zdfm.jpg)



# 页面是如何抗压的

你一定想到了缓存. 没错,就是他.

## 生成缓存

你可以执行:

`git clone ssh://git@ssh.gitlab.mfwdev.com:333/WebDev/localdb.git`

在`localdb/conf/sales.php`中配置生成缓存要调用的方法名(`sales/apps/sales/promotion/activity/facade/Api.php`). 

服务器`每分钟` 主动更新一次缓存. 





























